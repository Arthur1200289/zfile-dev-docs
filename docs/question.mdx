# 常见问题

## 忘记管理员账号密码 {#reset-pwd}

启用 debug 模式即可，参考：

[参数配置-debug模式](/config#debug)

## 为什么启动后无法访问

### 端口被占用

请自行检查 `zfile` 启动端口是否被占用

### jdk 版本错误

`zfile` 仅支持运行在 `jdk 1.8` 版本下，请执行命令 `java -version` 命令，查看 `jdk` 版本，包含类似以下字样才是 `jdk` 安装正确.

```bash showLineNumbers
openjdk version "1.8.0_292"
OpenJDK Runtime Environment (build 1.8.0_292-b10)
OpenJDK 64-Bit Server VM (build 25.292-b10, mixed mode)
```

### 防火墙未开启

可能是防火墙没开启. 下面介绍如何防火墙开启端口. 对于阿里云、腾讯云、谷歌云等厂商, 可能还需要额外去后台开启防火墙.

#### CentOS 7.x

```bash showLineNumbers
firewall-cmd --zone=public --add-port=8080/tcp --permanent # 开放 8080 端口
firewall-cmd --reload                                      # 重启firewall
```

#### Ubuntu 16.x / Debian 9.x

```bash showLineNumbers
iptables -I INPUT -p tcp --dport 8080 -j ACCEPT
iptables-save
sudo apt-get install iptables-persistent
sudo netfilter-persistent save
sudo netfilter-persistent reload
```



#### 宝塔面板

宝塔面板可以去后台开放端口:

![Snipaste_2020-01-30_18-54-42.png](https://cdn.jun6.net/2020/01/30/18fa335b407ae.png)


## 如何使用域名进行访问

方式1: 将域名 `A` 记录解析到服务器 IP, 即可通过 `域名:端口` 访问 (80 端口即可免输入端口).

方式2: 使用 `nginx` 或 `caddy` 等工具反向代理. 以下以宝塔面板为例:

首先点击 `网站` -> `新增站点`:

<img src="https://cdn.jun6.net/2020/01/30/558b35c21519c.png" className={'sm:w-2/3'}></img>

点击反向代理:

<img src="https://cdn.jun6.net/2020/01/30/2bf2585516f8d.png" className={'sm:w-2/3'}></img>

设置反向代理:

<img src="https://cdn.jun6.net/2020/01/30/ac865a78a617b.png" className={'sm:w-2/3'}></img>

## 如何查看当前的 ZFile 版本

在 `Chrome/Firefox` 系浏览器下打开 `ZFile` 任意页面，然后按 `F12` 键打开 `DevTools`，点 `Console` 栏，可看到版本信息。

<img src="https://cdn.jun6.net/uPic/2022/08/16/rWybqY.png" className={'sm:w-1/2'}></img>

## 上传超过 50M 的文件失败

宝塔 `nginx` 默认只支持上传最大 `50MB` 的文件，可去以下页面进行设置:

<img src="https://cdn.jun6.net/uPic/2022/08/16/uxPAXY.png"/>
<img src="https://cdn.jun6.net/uPic/2022/08/16/Jx2P2s.png"/>


## 中文显示异常或者文件过滤对中文目录无效 {#system-locale}

因为系统没有使用 utf8 编码，导致不支持中文.

### 查看当前系统编码

```bash showLineNumbers
locale
```

会出现以下内容：

```bash showLineNumbers
[root@VM-0-8-centos]~# locale
LANG=en_US.UTF-8
LC_CTYPE="en_US.UTF-8"
LC_NUMERIC="en_US.UTF-8"
LC_TIME="en_US.UTF-8"
LC_COLLATE="en_US.UTF-8"
LC_MONETARY="en_US.UTF-8"
LC_MESSAGES="en_US.UTF-8"
LC_PAPER="en_US.UTF-8"
LC_NAME="en_US.UTF-8"
LC_ADDRESS="en_US.UTF-8"
LC_TELEPHONE="en_US.UTF-8"
LC_MEASUREMENT="en_US.UTF-8"
LC_IDENTIFICATION="en_US.UTF-8"
LC_ALL=
```

一般为 `xxx.UTF-8` 才正常，如果为 `POSIX` 或其他的话，可能就是不支持中文的编码.

### 查看系统支持的编码

```bash showLineNumbers
locale -a
```

会出现以下内容：
```bash showLineNumbers
[root@JM-SRV-WEB ~]# locale -a
C
C.utf8
POSIX
en_AG
en_AU
en_AU.utf8
en_BW
en_BW.utf8
en_CA
en_CA.utf8
en_DK
en_DK.utf8
en_GB
en_GB.iso885915
en_GB.utf8
en_HK
en_HK.utf8
en_IE
en_IE.utf8
en_IE@euro
en_IL
en_IN
en_NG
en_NZ
en_NZ.utf8
en_PH
en_PH.utf8
en_SC.utf8
en_SG
en_SG.utf8
en_US
en_US.iso885915
en_US.utf8
en_US@ampm.UTF-8
en_ZA
en_ZA.utf8
en_ZM
en_ZW
en_ZW.utf8
```

可能显示的内容有多有少，显示的内容为系统支持的编码，一般来说，设置成 `en_US.UTF-8` 或 `C.utf8` 或 `zh_CN.utf8`，都是正常的. （要保证设置的值出现在上述列表中）

### 设置系统编码

已设置为 `en_US.UTF-8` 为例：

```bash showLineNumbers
localectl set-locale LANG=en_US.UTF-8
```

### 重启系统

**重启你的服务器，而不是重启 zfile**，重启后再去 zfile 查看中文编码是否正常。



## ZFile 修改静态资源

### 社区版

待补充...

### 捐赠版

以脚本部署为例，默认解压后文件路径为 `/root/zfile-pro`，文件内容如下图：

![](https://cdn.jun6.net/uPic/2022/09/26/LQ0p9D.png)

修改配置文件方式如下图:

![](https://cdn.jun6.net/uPic/2022/09/26/EdO6Bv.png)

注: 其他部署方式，也是类似的逻辑，如找不到 static 目录，可以去 https://c.jun6.net/ZFILE-PRO/ 随便下载一个 xjar 后缀的文件解压，里面就有 static 目录了. 配置文件这个地址也有：https://c.jun6.net/ZFILE-PRO/application.properties